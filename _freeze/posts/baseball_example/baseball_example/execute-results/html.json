{
  "hash": "d38ec49353bc0df4351014031521801d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Andre Ethier versus Brad Lidge\"\nauthor: \"Derek Sollberger\"\ndate: \"2025-07-16\"\nformat:\n  html\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"Lahman\")\nlibrary(\"retrosheet\")\nlibrary(\"tidyverse\")\n```\n:::\n\n\n\n\n# Setting the Scene\n\nI am finally reading [Analyzing Baseball Data with R](https://beanumber.github.io/abdwr3e/), and thankfully there is a book club over at the DSLC Slack channel (Data Science Learning Community). I want to apply our new skills to a particular half-inning that is cherished in my memories. In particular, I want to see if I can find *a particular at-bat by Andre Ethier where he faced Brad Lidge in the bottom of the ninth* ...\n\nAfter volunteering to present the chapter on Quarto for our book club, I have decided to proceed through the materials as if I was giving a review session.\n\n\n# Ch 1: Data Sets\n\n## Lahman\n\nThe [Lahman](https://github.com/cdalzell/Lahman) data set can help us find overall information through its `People`, `Batting`, `Pitching`, `Fielding`, and `Teams` tables (and this data set is more extensive than I remember). First, let us find certain players in the `People` table:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nLahman::People |>\n  filter(nameLast %in% c(\"Ethier\", \"Lidge\", \"Werth\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   playerID birthYear birthMonth birthDay   birthCity birthCountry birthState\n1 ethiean01      1982          4       10     Phoenix          USA         AZ\n2 lidgebr01      1976         12       23  Sacramento          USA         CA\n3 werthde01      1952         12       29     Lincoln          USA         IL\n4 werthja01      1979          5       20 Springfield          USA         IL\n  deathYear deathMonth deathDay deathCountry deathState deathCity nameFirst\n1        NA         NA       NA         <NA>       <NA>      <NA>     Andre\n2        NA         NA       NA         <NA>       <NA>      <NA>      Brad\n3        NA         NA       NA         <NA>       <NA>      <NA>    Dennis\n4        NA         NA       NA         <NA>       <NA>      <NA>    Jayson\n  nameLast            nameGiven weight height bats throws      debut   bbrefID\n1   Ethier        Andre Everett    210     74    L      L 2006-05-02 ethiean01\n2    Lidge       Bradley Thomas    210     77    R      R 2002-04-26 lidgebr01\n3    Werth          Dennis Dean    200     73    R      R 1979-09-17 werthde01\n4    Werth Jayson Richard Gowan    235     77    R      R 2002-09-01 werthja01\n   finalGame  retroID deathDate  birthDate\n1 2017-10-01 ethia001      <NA> 1982-04-10\n2 2012-06-16 lidgb001      <NA> 1976-12-23\n3 1982-09-27 wertd101      <NA> 1952-12-29\n4 2017-10-01 wertj001      <NA> 1979-05-20\n```\n\n\n:::\n:::\n\n\n\nWe will need these player IDs (the latter one in the case of \"Werth\"). I will now try to look up Ethier, Lidge, and Werth in the `Batting`, `Pitching`, and `Fielding` tables respectively.\n\n::::: {.panel-tabset}\n\n### Batting\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nLahman::Batting |>\n  filter(playerID == \"ethiean01\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    playerID yearID stint teamID lgID   G  AB  R   H X2B X3B HR RBI SB CS BB\n1  ethiean01   2006     1    LAN   NL 126 396 50 122  20   7 11  55  5  5 34\n2  ethiean01   2007     1    LAN   NL 153 447 50 127  32   2 13  64  0  4 46\n3  ethiean01   2008     1    LAN   NL 141 525 90 160  38   5 20  77  6  3 59\n4  ethiean01   2009     1    LAN   NL 160 596 92 162  42   3 31 106  6  4 72\n5  ethiean01   2010     1    LAN   NL 139 517 71 151  33   1 23  82  2  1 59\n6  ethiean01   2011     1    LAN   NL 135 487 67 142  30   0 11  62  0  1 58\n7  ethiean01   2012     1    LAN   NL 149 556 79 158  36   1 20  89  2  2 50\n8  ethiean01   2013     1    LAN   NL 142 482 54 131  33   2 12  52  4  3 61\n9  ethiean01   2014     1    LAN   NL 130 341 29  85  17   6  4  42  2  2 31\n10 ethiean01   2015     1    LAN   NL 142 395 54 116  20   7 14  53  2  3 43\n11 ethiean01   2016     1    LAN   NL  16  24  2   5   1   0  1   2  0  0  2\n12 ethiean01   2017     1    LAN   NL  22  34  3   8   1   0  2   3  0  0  4\n    SO IBB HBP SH SF GIDP\n1   77   2   5  0  6   11\n2   68  12   4  0  8   10\n3   88   0   4  1  7    6\n4  116  10  13  0  4   19\n5  102  11   3  0  6   11\n6  103   9   3  0  3    8\n7  124   6   9  0  3   13\n8   95  11   7  0  3    9\n9   74   3   6  1  1    5\n10  75   2   4  0  3   11\n11   6   1   0  0  0    1\n12  10   1   0  0  0    0\n```\n\n\n:::\n:::\n\n\n\n### Pitching\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nLahman::Pitching |>\n  filter(playerID == \"lidgebr01\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    playerID yearID stint teamID lgID W L  G GS CG SHO SV IPouts  H ER HR BB\n1  lidgebr01   2002     1    HOU   NL 1 0  6  1  0   0  0     26 12  6  0  9\n2  lidgebr01   2003     1    HOU   NL 6 3 78  0  0   0  1    255 60 34  6 42\n3  lidgebr01   2004     1    HOU   NL 6 5 80  0  0   0 29    284 57 20  8 30\n4  lidgebr01   2005     1    HOU   NL 4 4 70  0  0   0 42    212 58 18  5 23\n5  lidgebr01   2006     1    HOU   NL 1 5 78  0  0   0 32    225 69 44 10 36\n6  lidgebr01   2007     1    HOU   NL 5 3 66  0  0   0 19    201 54 25  9 30\n7  lidgebr01   2008     1    PHI   NL 2 0 72  0  0   0 41    208 50 15  2 35\n8  lidgebr01   2009     1    PHI   NL 0 8 67  0  0   0 31    176 72 47 11 34\n9  lidgebr01   2010     1    PHI   NL 1 1 50  0  0   0 27    137 32 15  5 24\n10 lidgebr01   2011     1    PHI   NL 0 2 25  0  0   0  1     58 16  3  0 13\n11 lidgebr01   2012     1    WAS   NL 0 1 11  0  0   0  2     28 12 10  1 11\n    SO BAOpp  ERA IBB WP HBP BK BFP GF  R SH SF GIDP\n1   12 0.333 6.23   1  0   2  0  48  2  6  1  0    1\n2   97 0.202 3.60   7  4   5  1 349  9 36  2  3    6\n3  157 0.174 1.90   5  3   6  1 369 44 21  3  2    5\n4  103 0.223 2.29   1  8   3  0 291 65 21  4  1    1\n5  104 0.238 5.28   4 11   6  0 340 52 47  6  2    2\n6   88 0.219 3.36   4  6   4  0 287 34 29  5  1    3\n7   92 0.198 1.95   4  5   1  0 292 61 17  2  1    3\n8   61 0.301 7.21   3  4   5  0 283 55 51  4  1    4\n9   52 0.194 2.96   4  3   1  1 193 38 16  3  0    2\n10  23 0.225 1.40   3  2   1  0  86  4  3  1  0    1\n11  10 0.308 9.64   5  0   0  0  51  4 10  1  0    0\n```\n\n\n:::\n:::\n\n\n\n### Fielding\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nLahman::Fielding |>\n  filter(playerID == \"werthja01\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    playerID yearID stint teamID lgID POS   G  GS InnOuts  PO  A E DP PB WP SB\n1  werthja01   2002     1    TOR   AL  OF  15  13     363  33  1 0  0 NA NA NA\n2  werthja01   2003     1    TOR   AL  OF  20  11     324  27  1 0  0 NA NA NA\n3  werthja01   2004     1    LAN   NL  OF  79  70    1932 146  6 4  2 NA NA NA\n4  werthja01   2005     1    LAN   NL  OF 101  96    2493 218  6 3  2 NA NA NA\n5  werthja01   2007     1    PHI   NL  1B   1   0       3   1  0 0  0 NA NA NA\n6  werthja01   2007     1    PHI   NL  OF  76  63    1727 147  9 2  2 NA NA NA\n7  werthja01   2008     1    PHI   NL  OF 125 103    2898 231  9 2  2 NA NA NA\n8  werthja01   2009     1    PHI   NL  OF 157 152    4138 353 11 6  4 NA NA NA\n9  werthja01   2010     1    PHI   NL  OF 153 150    4026 293  8 4  2 NA NA NA\n10 werthja01   2011     1    WAS   NL  OF 149 148    3973 342 11 8  4 NA NA NA\n11 werthja01   2012     1    WAS   NL  OF  79  79    2076 166  4 1  1 NA NA NA\n12 werthja01   2013     1    WAS   NL  OF 126 126    3216 235  7 2  1 NA NA NA\n13 werthja01   2014     1    WAS   NL  OF 139 137    3662 247  8 5  1 NA NA NA\n14 werthja01   2015     1    WAS   NL  OF  86  84    2162 113  3 2  0 NA NA NA\n15 werthja01   2016     1    WAS   NL  OF 133 133    3474 201  5 1  1 NA NA NA\n16 werthja01   2017     1    WAS   NL  OF  67  67    1655 116  1 4  0 NA NA NA\n   CS ZR\n1  NA NA\n2  NA NA\n3  NA NA\n4  NA NA\n5  NA NA\n6  NA NA\n7  NA NA\n8  NA NA\n9  NA NA\n10 NA NA\n11 NA NA\n12 NA NA\n13 NA NA\n14 NA NA\n15 NA NA\n16 NA NA\n```\n\n\n:::\n:::\n\n\n\n:::::\n\n## Retrosheet\n\nLet us try out the [retrosheet package](https://cran.r-project.org/web/packages/retrosheet/index.html) (by Colin Douglas and Richard Scriven) to get **game data** from each of those four seasons where *Brad Lidge was pitching for the Philadelphia Phillies*. Note: we probably do not have to concern ourselves with mid-season trades in this case study.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nseason_2008 <- retrosheet::get_retrosheet(\"game\", 2008)\nseason_2009 <- retrosheet::get_retrosheet(\"game\", 2009)\nseason_2010 <- retrosheet::get_retrosheet(\"game\", 2010)\nseason_2011 <- retrosheet::get_retrosheet(\"game\", 2011)\n```\n:::\n\n\n\n\n## Statcast\n\nAs recommended by the textbook authors in section C.2, we can load a list of player IDs for Statcast data (takes a few seconds to load and download)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchadwick_id <- baseballr::chadwick_player_lu()\nreadr::write_rds(chadwick_id, \"data/chadwick_id.rds\")\nchadwick_id <- readr::read_rds(\"data/chadwick_id.rds\")\n\nstatcast_ids <- chadwick_id |>\n  filter(name_last %in% c(\"Ethier\", \"Lidge\", \"Werth\")) |>\n  select(key_mlbam, name_last, name_first, mlb_played_first, mlb_played_last) |>\n  filter(!is.na(mlb_played_first))\nreadr::write_rds(statcast_ids, \"data/statcast_id.rds\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstatcast_ids <- readr::read_rds(\"data/statcast_ids.rds\")\nstatcast_ids\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 Ã— 5\n  key_mlbam name_last name_first mlb_played_first mlb_played_last\n      <int> <chr>     <chr>                 <int>           <int>\n1    400058 Lidge     Brad                   2002            2012\n2    124099 Werth     Dennis                 1979            1982\n3    444843 Ethier    Andre                  2006            2017\n4    150029 Werth     Jayson                 2002            2017\n```\n\n\n:::\n:::\n\n\n\n\n# Ch 2: dplyr\n\nFor this case study, we can use the `filter` command from the `dplyr` to subset our data where\n\n* visiting team: Philadelphia Phillies\n* home team: Los Angeles Dodgers\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlidge_phillies <- rbind(season_2008, season_2009, season_2010, season_2011) |>\n  dplyr::filter(VisTm == \"PHI\" & HmTm == \"LAN\")\nlidge_phillies |> select(Date, VisTm, HmTm, VisRuns, HmRuns, Attendance)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         Date VisTm HmTm VisRuns HmRuns Attendance\n1  2008-08-11   PHI  LAN       6      8      45547\n2  2008-08-12   PHI  LAN       3      4      47586\n3  2008-08-13   PHI  LAN       6      7      45786\n4  2008-08-14   PHI  LAN       1      3      51060\n5  2009-06-04   PHI  LAN       3      0      33839\n6  2009-06-05   PHI  LAN       3      4      52538\n7  2009-06-06   PHI  LAN       2      3      41412\n8  2009-06-07   PHI  LAN       7      2      42288\n9  2010-08-30   PHI  LAN       0      3      44896\n10 2010-08-31   PHI  LAN       8      4      45164\n11 2010-09-01   PHI  LAN       5      1      37080\n12 2011-08-08   PHI  LAN       5      3      35380\n13 2011-08-09   PHI  LAN       2      1      46547\n14 2011-08-10   PHI  LAN       9      8      41807\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n::: {.callout-note collapse=\"true\"}\n## Session Info\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.5.0 (2025-04-11 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 10 x64 (build 19045)\n\nMatrix products: default\n  LAPACK version 3.12.1\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] lubridate_1.9.4  forcats_1.0.0    stringr_1.5.1    dplyr_1.1.4     \n [5] purrr_1.0.4      readr_2.1.5      tidyr_1.3.1      tibble_3.2.1    \n [9] ggplot2_3.5.2    tidyverse_2.0.0  retrosheet_1.1.6 Lahman_12.0-0   \n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.6       jsonlite_2.0.0     compiler_4.5.0     tidyselect_1.2.1  \n [5] xml2_1.3.8         scales_1.4.0       yaml_2.3.10        fastmap_1.2.0     \n [9] R6_2.6.1           generics_0.1.4     curl_6.3.0         knitr_1.50        \n[13] htmlwidgets_1.6.4  tzdb_0.5.0         pillar_1.10.2      RColorBrewer_1.1-3\n[17] rlang_1.1.6        utf8_1.2.5         stringi_1.8.7      xfun_0.52         \n[21] timechange_0.3.0   cli_3.6.5          withr_3.0.2        magrittr_2.0.3    \n[25] digest_0.6.37      rvest_1.0.4        grid_4.5.0         rstudioapi_0.17.1 \n[29] hms_1.1.3          lifecycle_1.0.4    vctrs_0.6.5        evaluate_1.0.3    \n[33] glue_1.8.0         farver_2.1.2       rmarkdown_2.29     httr_1.4.7        \n[37] tools_4.5.0        pkgconfig_2.0.3    htmltools_0.5.8.1 \n```\n\n\n:::\n:::\n\n\n:::\n\n\n:::: {.columns}\n\n::: {.column width=\"45%\"}\n\t\n:::\n\n::: {.column width=\"10%\"}\n\t\n:::\n\n::: {.column width=\"45%\"}\n\n:::\n\n::::\n\n::::: {.panel-tabset}\n\n\n\n:::::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}