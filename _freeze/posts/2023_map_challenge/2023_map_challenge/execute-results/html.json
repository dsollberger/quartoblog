{
  "hash": "d33f6f1011e9069691b6ce75cc92960e",
  "result": {
    "markdown": "---\ntitle: \"30 Day Map Challenge\"\nauthor: \"Derek Sollberger\"\ndate: \"2023-11-05\"\nformat: \n  html:\n    toc: true\n---\n\n\n## Introduction\n\nEven though I have done the [30 Day Map Challenge](https://30daymapchallenge.com/) each of the past two years, since data visualization is just a hobby for me, I feel like I start from scratch each time.  This year, I decided to lean into that feeling and treat the month as production of a long blog post that likewise nearly starts from scratch.\n\n![](30dmc-2023.png)\n\nI am interested in learning about the state of New Jersey, and we will perhaps get data from sites such as\n\n* [NJDEP Bureau of GIS](https://www.nj.gov/dep/gis/) and its [ArcGIS repository](https://gisdata-njdep.opendata.arcgis.com/) \n* [NJGIN Open Data](https://njogis-newjersey.opendata.arcgis.com/)\n\nMost of my work here will be performed with the `ggplot2` and `sf` (\"special features\") packages in the `R` programmer universe.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"dplyr\")\nlibrary(\"ggameboy\")\nlibrary(\"ggplot2\")\nlibrary(\"ggtext\")\nlibrary(\"patchwork\")\nlibrary(\"sf\")\nlibrary(\"showtext\")\n```\n:::\n\n\n\n# Day 1: Points\n\nInitially, my searches for \"New Jersey cities shapefile\" and \"New Jersey colleges shapefile\" actually retrived polygons, so I am already taking liberties about what 'points' will mean here.  I still intend on starting simple and working outward.\n\nFirst, we load the shapefile.  This data comes from the NJGIN ([source](https://njogis-newjersey.opendata.arcgis.com/datasets/60070a28b95248e9a1f3398d37b91775/explore))\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnj_colleges <- sf::st_read(\"data/Colleges_and_Universities_in_NJ/Colleges_and_Universities_in_NJ.shp\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `Colleges_and_Universities_in_NJ' from data source \n  `C:\\Users\\freex\\Documents\\GitHub\\quartoblog\\posts\\2023_map_challenge\\data\\Colleges_and_Universities_in_NJ\\Colleges_and_Universities_in_NJ.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 78 features and 25 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 218539.1 ymin: 97707.92 xmax: 631389.8 ymax: 822455.9\nProjected CRS: NAD83 / New Jersey (ftUS)\n```\n:::\n:::\n\n\nNow, we can make an initial map using `ggplot2`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# make rough map\nnj_colleges |>\n  ggplot() +\n  geom_sf()\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n## Graph Labels\n\nFor now, I should get in the habit of labeling my graphs.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnj_colleges |>\n  ggplot() +\n  geom_sf() +\n  labs(title = \"Colleges of New Jersey\",\n       subtitle = \"30 Day Map Challenge, Day 1: Points\",\n       caption = \"Data source: NJGIN\")\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nOf course, this product lacks meaning without context, but that gives us something to look forward to in future days!\n\n\n# Day 2: Lines\n\nEach 30 Day Map Challenge probably started with the same first 3 themes to emphasize one of the main ways to classify spatial data: points, lines, and polygons.  Those notions affect how the data is stored in shapefiles.\n\nToday, in the theme of building maps about New Jersey, let us simply plot the state itself.  Once again, I will intentionally miss the academic meaning of the theme (\"lines\"); the data is of polygon type, but I am thinking of the state border as one line.  This data comes from the NJGIN ([source](https://njogis-newjersey.opendata.arcgis.com/datasets/state-boundary-of-nj/explore))\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnj_state_shp <- sf::st_read(\"data/State_Boundary_of_NJ/State_Boundary_of_NJ.shp\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `State_Boundary_of_NJ' from data source \n  `C:\\Users\\freex\\Documents\\GitHub\\quartoblog\\posts\\2023_map_challenge\\data\\State_Boundary_of_NJ\\State_Boundary_of_NJ.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 1 feature and 9 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 191987.2 ymin: 7591.33 xmax: 659494.9 ymax: 919556.3\nProjected CRS: NAD83 / New Jersey (ftUS)\n```\n:::\n:::\n\n\nWe can continue to adapt code and apply yesterday's code to today's shapefile.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnj_state_shp |> #changed the data set\n  ggplot() +\n  geom_sf() +\n  labs(title = \"The State of New Jersey\",\n       subtitle = \"30 Day Map Challenge, Day 2: Lines\",\n       caption = \"Data source: NJGIN\")\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n## Aesthetic Customization\n\nEach day, I may challenge myself to add to the complexity.  For now, let us emphasize the \"line\" in the picture by customizing the color.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnj_state_shp |>\n  ggplot() +\n  geom_sf(color = \"blue\", linewidth = 3) + #updated attributes\n  labs(title = \"The State of New Jersey\",\n       subtitle = \"30 Day Map Challenge, Day 2: Lines\",\n       caption = \"Data source: NJGIN\")\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n# Day 3: Polygons\n\nWell, after actually using 'polygon' data in the previous two days, finally being advised to use polygons should be simple here.  For mentally planning ideas for map making, one can think \"regions\" when dealing with polygon data. This data comes from the NJGIN ([source](https://njogis-newjersey.opendata.arcgis.com/datasets/newjersey::county-boundaries-of-nj/explore))\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnj_counties <- sf::st_read(\"data/County_Boundaries_of_NJ/County_Boundaries_of_NJ.shp\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `County_Boundaries_of_NJ' from data source \n  `C:\\Users\\freex\\Documents\\GitHub\\quartoblog\\posts\\2023_map_challenge\\data\\County_Boundaries_of_NJ\\County_Boundaries_of_NJ.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 21 features and 24 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 193684.7 ymin: 34945.75 xmax: 657059.7 ymax: 919556.3\nProjected CRS: NAD83 / New Jersey (ftUS)\n```\n:::\n:::\n\n\nNotice that the `geom_sf` layer function works in the `ggplot` framework and will handle the polygon data well.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnj_counties |>\n  ggplot() +\n  geom_sf() +\n  labs(title = \"The Counties of New Jersey\",\n       subtitle = \"30 Day Map Challenge, Day 3: Polygons\",\n       caption = \"Data source: NJGIN\")\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n## Aesthetic Mapping\n\nOne of the joys of programming in R is the ease of color-coding by a categorical label.  Here, we can create a rather impressive map by letting the software choose various colors for the counties.\n\nFirst, we should get a sense of the variable names.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(nj_counties)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"OBJECTID\"   \"GLOBALID\"   \"COUNTY\"     \"COUNTY_LAB\" \"CO\"        \n [6] \"GNIS_NAME\"  \"GNIS\"       \"FIPSSTCO\"   \"FIPSCO\"     \"ACRES\"     \n[11] \"SQ_MILES\"   \"POP2020\"    \"POP2010\"    \"POP2000\"    \"POP1990\"   \n[16] \"POP1980\"    \"POPDEN2020\" \"POPDEN2010\" \"POPDEN2000\" \"POPDEN1990\"\n[21] \"POPDEN1980\" \"REGION\"     \"Shape_Leng\" \"Shape_Area\" \"geometry\"  \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnj_counties |>\n  ggplot() +\n  geom_sf(aes(fill = COUNTY)) +\n  labs(title = \"The Counties of New Jersey\",\n       subtitle = \"30 Day Map Challenge, Day 3: Polygons\",\n       caption = \"Data source: NJGIN\") +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n# Day 4: A Bad Map\n\nIf you're following along, you might have wondered why I didn't label the counties in the previous map.  Here, for \"Day 4: A Bad Map\", let me show you.\n\n## Centroids\n\nThe way that `geom_text` or `geom_label` work inside `ggplot` is that you need to indicate the aesthetics of locations (i.e. x and y coordinates) and labels.  That is, while polygons are many points of data, we need to compute one point per polygon to tell the software where to put the labels.  One way to compute those locations is to compute the centroids (and, long story short, there are several ways to compute centroids).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the centroid of each hexagon to add the label\n# https://stackoverflow.com/questions/49343958/do-the-values-returned-by-rgeosgcentroid-and-sfst-centroid-differ\ncenters <- data.frame(\n  st_coordinates(st_centroid(nj_counties$geometry)),\n  id=nj_counties$COUNTY)\n\nnj_counties <- nj_counties |>\n  left_join(centers, by = c(\"COUNTY\" = \"id\"))\n```\n:::\n\n\nNow, the data frame has convenient \"X\" and \"Y\" coordinates (which happen to be capital letters in these default codes).\n\n## Aesthetic Labeling\n\nNow let us see how `geom_label` works with our map so far.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnj_counties |>\n  ggplot() +\n  geom_sf(aes(fill = COUNTY)) +\n  geom_label(aes(x = X, y = Y, label = COUNTY)) +\n  labs(title = \"The Counties of New Jersey\",\n       subtitle = \"30 Day Map Challenge, Day 4: A Bad Map\",\n       caption = \"Data source: NJGIN\") +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nThere are certainly ways to improve the readability and beauty of this map, and we might explore those ways in future days.\n\n\n# Day 5: Analog Map\n\nThe intent of the 'Analog Map' theme is to encourage us map making nerds to draw a map \"in real life\" (or, \"in meat space\"). However, there is an idea that has been on my mind, so I want to try to overlap shapefiles of New Jersey and California---that is, closer to the word \"analogy\".\n\nToday's shapefile for the state of California comes from the [California Open Data Portal](https://data.ca.gov/dataset/ca-geographic-boundaries/resource/3db1e426-fb51-44f5-82d5-a54d7c6e188b).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca_state_shp <- sf::st_read(\"data/ca-state-boundary/CA_State_TIGER2016.shp\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `CA_State_TIGER2016' from data source \n  `C:\\Users\\freex\\Documents\\GitHub\\quartoblog\\posts\\2023_map_challenge\\data\\ca-state-boundary\\CA_State_TIGER2016.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 1 feature and 14 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -13857270 ymin: 3832931 xmax: -12705030 ymax: 5162404\nProjected CRS: WGS 84 / Pseudo-Mercator\n```\n:::\n:::\n\n\n## Coordinate Reference Systems\n\nLong story short, each map of the 3D Earth is projected onto a 2D plane, but there are ways to perform that projection (with goals such as maintaining areas or shapes as well as possible).  For our purposes, the work here will be easier if both of the California and New Jersey shapefiles use the same projection.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# check CRS\nst_crs(ca_state_shp)[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$input\n[1] \"WGS 84 / Pseudo-Mercator\"\n```\n:::\n\n```{.r .cell-code}\nst_crs(nj_state_shp)[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$input\n[1] \"NAD83 / New Jersey (ftUS)\"\n```\n:::\n:::\n\n\nWe can observe that the projection systems are not the same. Hopefully, the simplest fix is to simply re-project the CRS of the California shapefile into the CRS of the New Jersey shapefile.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# set CRS\n# st_crs(ca_state_shp) <- st_crs(nj_state_shp)\nca_state_shp <- st_transform(ca_state_shp, st_crs(nj_state_shp))\n\n# verify\nst_crs(ca_state_shp)[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$input\n[1] \"NAD83 / New Jersey (ftUS)\"\n```\n:::\n:::\n\n\nSo far, here is the juxtaposition.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnj_state_shp |>\n  ggplot() +\n  geom_sf() +\n  geom_sf(data = ca_state_shp)\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\n## Coordinates\n\nFor some of the math I intend on carrying out, I will need to manipulate the latitude and/or longitude values (i.e. the x and y coordinates). We can extract coordinates using the `st_geometry` command.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca_sfc <- st_geometry(ca_state_shp) #extracts geom column\nnj_sfc <- st_geometry(nj_state_shp) #extracts geom column\n```\n:::\n\n\nNext, I want the median longitude value for each shapefile.  I am going to brute force my way through the list data type.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ca_long_median_x <- median(ca_sfc[[1]][[7]][[1]][,1])\n# nj_long_median_x <- median(nj_sfc[[1]][[1]][,1])\n# median_difference_x <- nj_long_median_x - ca_long_median_x\n# \n# ca_long_median_y <- median(ca_sfc[[1]][[7]][[1]][,2])\n# nj_long_median_y <- median(nj_sfc[[1]][[1]][,2])\n# median_difference_y <- nj_long_median_y - ca_long_median_y\n```\n:::\n\n\nMaybe centroids will work better?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca_centroid <- st_coordinates(st_centroid(ca_state_shp$geometry))\nnj_centroid <- st_coordinates(st_centroid(nj_state_shp$geometry))\nlong_diff <- nj_centroid[1] - ca_centroid[1]\nlat_diff <- nj_centroid[2] - ca_centroid[2]\n```\n:::\n\n\n\n## Translation\n\nNow, I want to translate the Calfornia shape over to the New Jersey shape.  Some social media posts were clever by aligning San Francisco with New York City, but my interest came from maintaining latitude values (which might help me understand weather and climate), so that will take place with the zero in `c(median_difference, 0)`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ca_shifted_sfc <- ca_sfc + c(median_difference_x, 0)\n# ca_shifted_shp <- st_set_geometry(ca_state_shp, ca_shifted_sfc)\n# st_crs(ca_shifted_shp) <- st_crs(nj_state_shp) #ensure same CRS\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# using the centroids instead\nca_shifted_sfc <- ca_sfc + c(long_diff, lat_diff)\nca_shifted_shp <- st_set_geometry(ca_state_shp, ca_shifted_sfc)\nst_crs(ca_shifted_shp) <- st_crs(nj_state_shp) #ensure same CRS\n```\n:::\n\n\nSo far, here is the juxtaposition. I decided to place the New Jersey layer on top of the Calfornia layer.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nca_shifted_shp |>\n  ggplot() +\n  geom_sf() +\n  geom_sf(data = nj_state_shp)\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\nI ended up maintaining the areas, but alas, not the latitude values.\n\n## Markdown Titles\n\nWith just two objects in one map, one neat way of labeling the objects is to change the text colors in the title using the `ggtext` package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntitle_string <- \"<span style='color:brown'><b>California</b></span> and <span style='color:blue'><b>New Jersey</b></span>\"\n\nca_shifted_shp |>\n  ggplot() +\n  geom_sf(color = \"brown\", fill = \"brown\") +\n  geom_sf(data = nj_state_shp, color = \"blue\", fill = \"blue\") +\n  labs(title = title_string,\n       subtitle = \"30 Day Map Challenge\\nDay 5: Analog Map\",\n       caption = \"Data sources: NJGIN\\nand CA Open Data Portal\") +\n  theme(plot.title = element_markdown()) #need ggtext here\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n\n# Day 6: Asia\n\nSeveral of the themes in this year's 30 Day Map Challenge are the names of the continents.  For this, I think I will answer the thought \"New Jersey is close to the size of ____\".\n\nThe following shapefile can be found in the Princeton University Library's Digital Maps and Geospatial Data collection.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# https://maps.princeton.edu/catalog/stanford-yt530bw9654\nkuwait_shp <- sf::st_read(\"data/Kuwait_data/KWT_adm1.shp\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `KWT_adm1' from data source \n  `C:\\Users\\freex\\Documents\\GitHub\\quartoblog\\posts\\2023_map_challenge\\data\\Kuwait_data\\KWT_adm1.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 6 features and 12 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 46.55062 ymin: 28.52461 xmax: 48.65403 ymax: 30.08444\nGeodetic CRS:  WGS 84\n```\n:::\n:::\n\n\nWe can store maps as variables in the R programming language.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkuwait_map <- kuwait_shp |> ggplot() + geom_sf()\nnj_map <- nj_state_shp |> ggplot() + geom_sf()\n```\n:::\n\n\n## Patchwork\n\nUsing the `patchwork` package, we can place the maps side-by-side.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# patchwork\nkuwait_map + nj_map +\n  plot_annotation(\n    title = \"Kuwait is close to the size of New Jersey\",\n    subtitle = \"30 Day Map Challenge, Day 6: Asia\",\n    caption = \"Data sources: NJGIN and Princeton Univ\"\n  )\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\n# Day 7: Navigation\n\nNow we get to what the \"Lines\" day could have been.  I downloaded a shapefile ([source](https://www.arcgis.com/home/item.html?id=2b11e237a6e149c0a94027780c22c9c4)) with all of the roads in New Jersey, but that was too much information for this casual project.  Also that file wasn't formatted in a way that was easy to digest\n\nInstead, I looked for a more sparse data set, and found [one](https://catalog.data.gov/dataset/tiger-line-shapefile-2019-state-new-jersey-primary-and-secondary-roads-state-based-shapefile) at Data.gov.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#nj_road_shp <- sf::st_read(\"data/Tran_road_NG911/Tran_road.shp\")\nnj_road_shp <- sf::st_read(\"data/tl_2019_34_prisecroads/tl_2019_34_prisecroads.shp\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `tl_2019_34_prisecroads' from data source \n  `C:\\Users\\freex\\Documents\\GitHub\\quartoblog\\posts\\2023_map_challenge\\data\\tl_2019_34_prisecroads\\tl_2019_34_prisecroads.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 2834 features and 4 fields\nGeometry type: LINESTRING\nDimension:     XY\nBounding box:  xmin: -75.52117 ymin: 38.94787 xmax: -73.91159 ymax: 41.35297\nGeodetic CRS:  NAD83\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnj_road_shp |> \n  ggplot() + \n  geom_sf() +\n  labs(title = \"The Major Roads of New Jersey\",\n       subtitle = \"30 Day Map Challenge, Day 7: Navigation\",\n       caption = \"Data source: Data.gov\")\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\nThis shapefile was easier to navigate (pun intended).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(nj_road_shp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 6 features and 4 fields\nGeometry type: LINESTRING\nDimension:     XY\nBounding box:  xmin: -74.64413 ymin: 40.48055 xmax: -74.04469 ymax: 40.73207\nGeodetic CRS:  NAD83\n        LINEARID            FULLNAME RTTYP MTFCC                       geometry\n1   110457975956 New Jersey Tpke Exd     M S1100 LINESTRING (-74.11917 40.69...\n2  1105046014336 New Jersey Tpke Exd     M S1100 LINESTRING (-74.11926 40.69...\n3  1105047389300 New Jersey Tpke Exd     M S1100 LINESTRING (-74.15602 40.70...\n4  1105646774349 New Jersey Tpke Exd     M S1100 LINESTRING (-74.04613 40.73...\n5  1105046014337 New Jersey Tpke Exd     M S1100 LINESTRING (-74.11926 40.69...\n6 11010934626794      US Hwy 206 Byp     U S1200 LINESTRING (-74.63902 40.48...\n```\n:::\n:::\n\n\nWe can highlight the road types.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnj_road_shp |> \n  ggplot() + \n  geom_sf(aes(color = RTTYP)) +\n  labs(title = \"The Major Roads of New Jersey\",\n       subtitle = \"30 Day Map Challenge, Day 7: Navigation\",\n       caption = \"Data source: Data.gov\")\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\n## Recoding\n\nLet us try to redo the labels in plain language according to the [US Census codes for road types](https://www.census.gov/library/reference/code-lists/route-type-codes.html).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnj_road_shp |> \n  mutate(road_type = case_match(RTTYP,\n    \"C\" ~ \"County\",\n    \"I\" ~ \"Interstate\",\n    \"M\" ~ \"common name\",\n    \"S\" ~ \"State recognized\",\n    \"U\" ~ \"U.S.\",\n    .default = \"other\"\n  )) |>\n  ggplot() + \n  geom_sf(aes(color = road_type)) +\n  labs(title = \"The Major Roads of New Jersey\",\n       subtitle = \"30 Day Map Challenge, Day 7: Navigation\",\n       caption = \"Data source: Data.gov\") +\n  scale_color_discrete(name = \"Road Type\")\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\n\n# Day 8: Africa\n\nThe country in Africa that is closest to the size of New Jersey is Eswatini.  Let us get that shapefile ([source](https://data.humdata.org/dataset/cod-ab-swz?)).\n\n\n::: {.cell}\n\n```{.r .cell-code}\neswatini_shp <- sf::read_sf(\"data/swz_admbnda_cso2007_shp/swz_admbnda_adm0_CSO_2007.shp\")\n```\n:::\n\n\nI am simply adapting code from before.\n\n\n::: {.cell}\n\n```{.r .cell-code}\neswatini_map <- eswatini_shp |> ggplot() + geom_sf()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# patchwork\neswatini_map + nj_map +\n  plot_annotation(\n    title = \"Eswatini is close to the size of New Jersey\",\n    subtitle = \"30 Day Map Challenge, Day 8: Africa\",\n    caption = \"Data sources: NJGIN and\\nHumanitarian Data Exchange\"\n  )\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n\n\n# Day 9: Hexagons\n\nIn years past, I combined state-by-state data with an established hexagon map of the United States.  Today, I am trying instead to apply a hexagon-cell heat map to some data.\n\nWhelp, I found some great data sets that would have been great here, but they were hosted on sites that did not actually have download links for open source use.  Instead, I will use a list of US cities found at [https://simplemaps.com/data/us-cities](https://simplemaps.com/data/us-cities).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_cities_df <- readr::read_csv(\"data/simplemaps_uscities/uscities.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 30844 Columns: 17\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (9): city, city_ascii, state_id, state_name, county_fips, county_name, s...\ndbl (6): lat, lng, population, density, ranking, id\nlgl (2): military, incorporated\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n\nNow we can make a density map of New Jersey cities (note: density map of the city names, not of the human populations).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_cities_df |>\n  filter(state_id == \"NJ\") |>\n  ggplot(aes(x = lng, y = lat)) +\n  geom_hex()\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n:::\n\n\n## Square Grid\n\nThe viewing window seems a bit skewed, and there is a lot of empty space.  Next, I will \n\n* apply a `coord_equal` layer\n* change the `geom_hex` binwidth (by guess-and-check)\n* apply slightly more divergent colors\n\n\n::: {.cell}\n\n```{.r .cell-code}\nus_cities_df |>\n  filter(state_id == \"NJ\") |>\n  ggplot(aes(x = lng, y = lat)) +\n  coord_equal() +\n  geom_hex(binwidth = c(0.15, 0.15)) +\n  labs(title = \"Density Map of New Jersey Cities\",\n       subtitle = \"30 Day Map Challenge, Day 9: Hexagons\",\n       caption = \"Data Source: SimpleMaps\") +\n  scale_fill_gradient(low = \"green\", high = \"blue\")\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-38-1.png){width=672}\n:::\n:::\n\n\n\n# Day 10: North America\n\nWhile pointing out New Jersey in a larger map of North America subdivisions (states, provinces) makes sense here, I am going to contine my silly comparison of land mass sizes.\n\nAmong countries in North America, the one closest in size to New Jersey is El Salvador.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nel_salvador_shp <- sf::read_sf(\"data/slv_adm_gadm_2021_shp/slv_admbnda_adm0_gadm_20210204.shp\")\n```\n:::\n\n\nI am once again adapting code from before.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nel_salvador_map <- el_salvador_shp |> ggplot() + geom_sf()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# patchwork\nel_salvador_map + nj_map +\n  plot_annotation(\n    title = \"El Salvador is close to the size of New Jersey\",\n    subtitle = \"30 Day Map Challenge, Day 10: North America\",\n    caption = \"Data sources: NJGIN and\\nHumanitarian Data Exchange\"\n  )\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-41-1.png){width=672}\n:::\n:::\n\n\n\n# Day 11: Retro\n\nI heard about a \"Gameboy theme\" among the R packages.  It doesn't seem to be compatible with current versions of R, but perhaps we can simply adopt a color scheme instead?\n\n* [https://www.designpieces.com/palette/game-boy-original-color-palette-hex-and-rgb/](https://www.designpieces.com/palette/game-boy-original-color-palette-hex-and-rgb/)\n\nLet us apply it to our counties map.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnj_counties |>\n  ggplot() +\n  geom_sf(color = \"#8bac0f\", \n          fill = \"#306230\", \n          size = 3) +\n  labs(title = \"The Counties\\nof New Jersey\") +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        axis.ticks.x = element_blank(),\n        axis.ticks.y = element_blank(),\n        panel.background = element_rect(fill = \"#9bbc0f\"),\n        panel.grid.major = element_blank(),\n        plot.background = element_rect(fill = \"#9bbc0f\"),\n        plot.title = element_text(color = \"#0f380f\",,\n                                  hjust = 0.5, \n                                  size = 20))\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-42-1.png){width=672}\n:::\n:::\n\n\n## Fonts\n\nNext, perhaps we can apply some sort of \"GameBoy\" font to our image?\n\n* followed [this vignette](https://cran.rstudio.com/web/packages/showtext/vignettes/introduction.html)\n* grabbed [this font](https://fonts.google.com/specimen/Press+Start+2P) from Google Fonts\n* aided by [this Stack Overflow post](https://stackoverflow.com/questions/71573377/cannot-import-fonts-into-r)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfont_add_google(\"Press Start 2P\", \"gameboy\")\nshowtext_auto()\n\nnj_counties |>\n  ggplot() +\n  geom_sf(color = \"#8bac0f\", \n          fill = \"#306230\", \n          size = 3) +\n  labs(title = \"The Counties\\nof New Jersey\") +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        axis.ticks.x = element_blank(),\n        axis.ticks.y = element_blank(),\n        panel.background = element_rect(fill = \"#9bbc0f\"),\n        panel.grid.major = element_blank(),\n        plot.background = element_rect(fill = \"#9bbc0f\"),\n        plot.title = element_text(color = \"#0f380f\", \n                                  family = \"gameboy\",\n                                  hjust = 0.5, \n                                  size = 10))\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-43-1.png){width=672}\n:::\n:::\n\n\n## Package: GameBoy\n\nIn my searches, I saw that there was a `ggameboy` package, so let's try it out!\n\n* [https://r-charts.com/miscellaneous/ggameboy/](https://r-charts.com/miscellaneous/ggameboy/)\n* [GameBoy console palette](https://www.color-hex.com/color-palette/100266)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngameboy_plot(Abutton = \"#9a2257\",\n             Bbutton = \"#9a2257\",\n             background = \"white\",\n             case = \"#C0C0C0\",\n             Done_col = \"white\",\n             glassframe = \"#555a56\",\n             screentext = \"30 Day Map Challenge\\nDay 11: Retro\",\n             select = \"#494786\",\n             start = \"#494786\")\n```\n\n::: {.cell-output-display}\n![](2023_map_challenge_files/figure-html/unnamed-chunk-44-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "2023_map_challenge_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}