{
  "hash": "ab29128d68db9b521dabf5a085f7aa9f",
  "result": {
    "markdown": "---\ntitle: \"Inequalities\"\nauthor: \"Derek Sollberger\"\ndate: \"2023-06-01\"\nformat: html\n---\n\n\nThere are probably several ways to graph mathematical inequalities in `R`.  Here, I will simply try a brute force method of literally plotting many dots.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"dplyr\")\nlibrary(\"ggplot2\")\n```\n:::\n\n\nHere, I will simply try a brute force method of literally plotting many dots.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nN <- 100 #resolution\nx <- seq(-10, 10, length.out = N)\ny <- seq(-10, 10, length.out = N)\n\ndf <- expand.grid(x,y)\ncolnames(df) <- c(\"xval\", \"yval\")\n```\n:::\n\n\nToday's tasks come from chapter 9 of the popular ISLR textbook\n\n# Conceptual Task 1a\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf1 <- df |>\n  # math function\n  mutate(shade = ifelse(yval > 3*xval + 1, \"blue\", \"red\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf1 |>\n  ggplot() +\n  \n  # shaded regions\n  geom_point(aes(x = xval, y = yval, color = shade),\n             alpha = 0.5) +\n  scale_color_identity() +\n  \n  # axes\n  geom_segment(aes(x = -10, y = 0, xend = 10, yend = 0),\n               alpha = 0.25, color = \"gray75\", linewidth = 2) +\n  geom_segment(aes(x = 0, y = -10, xend = 0, yend = 10),\n               alpha = 0.25, color = \"gray75\", linewidth = 2) +\n  \n  # main line\n  geom_segment(aes(x = -(11/3), y = -10, xend = 3, yend = 10),\n               color = \"black\", linewidth = 3) +\n  \n  # customization\n  coord_equal() +\n  labs(title = \"Separating Hyperplane\",\n       subtitle = \"y = 3x + 1\",\n       caption = \"ISLR\",\n       x = \"X1\", y = \"X2\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](inequalities_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n# Conceptual Task 1b\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf1b <- df |>\n  # math function\n  mutate(shade = ifelse(yval > 1 - 0.5*xval, \"blue\", \"red\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf1b |>\n  ggplot() +\n  \n  # shaded regions\n  geom_point(aes(x = xval, y = yval, color = shade),\n             alpha = 0.5) +\n  scale_color_identity() +\n  \n  # axes\n  geom_segment(aes(x = -10, y = 0, xend = 10, yend = 0),\n               alpha = 0.25, color = \"gray75\", linewidth = 2) +\n  geom_segment(aes(x = 0, y = -10, xend = 0, yend = 10),\n               alpha = 0.25, color = \"gray75\", linewidth = 2) +\n  \n  # main line\n  geom_segment(aes(x = -10, y = 6, xend = 10, yend = -4),\n               color = \"black\", linewidth = 3) +\n  \n  # customization\n  coord_equal() +\n  labs(title = \"Separating Hyperplane\",\n       subtitle = \"y = 1 - 0.5x\",\n       caption = \"ISLR\",\n       x = \"X1\", y = \"X2\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](inequalities_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n# Conceptual Task 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\neuclidean_distance <- function(x1, y1, x2, y2){\n  # computes the Euclidean distance between (x1, y1) and (x2, y2)\n  sqrt( (x2 - x1)^2 + (y2 - y1)^2 )\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf2 <- df |>\n  # math function\n  mutate(shade = ifelse(euclidean_distance(xval, yval, -1, 2) > 4, \n                        \"blue\", \"red\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf2 |>\n  ggplot() +\n  \n  # shaded regions\n  geom_point(aes(x = xval, y = yval, color = shade),\n             alpha = 0.5) +\n  scale_color_identity() +\n  \n  # axes\n  geom_segment(aes(x = -10, y = 0, xend = 10, yend = 0),\n               alpha = 0.25, color = \"gray75\", linewidth = 2) +\n  geom_segment(aes(x = 0, y = -10, xend = 0, yend = 10),\n               alpha = 0.25, color = \"gray75\", linewidth = 2) +\n  \n  # customization\n  coord_equal() +\n  labs(title = \"Separating Hyperplane\",\n       subtitle = \"(x+1)^2 + (y-2)^2 = 4\",\n       caption = \"ISLR\",\n       x = \"X1\", y = \"X2\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](inequalities_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n(c)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nifelse(euclidean_distance(0, 0, -1, 2) > 4, \"blue\", \"red\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"red\"\n```\n:::\n\n```{.r .cell-code}\nifelse(euclidean_distance(-1, 1, -1, 2) > 4, \"blue\", \"red\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"red\"\n```\n:::\n\n```{.r .cell-code}\nifelse(euclidean_distance(2, 2, -1, 2) > 4, \"blue\", \"red\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"red\"\n```\n:::\n\n```{.r .cell-code}\nifelse(euclidean_distance(3, 8, -1, 2) > 4, \"blue\", \"red\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"blue\"\n```\n:::\n:::\n\n\n\n# Conceptual Task 3\n\n(a)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nobs <- 1:7\nxvals <- c(3,2,4,1,2,4,4)\nyvals <- c(4,2,4,4,1,3,1)\nclass_label <- c(\"Red\", \"Red\", \"Red\", \"Red\", \"Blue\", \"Blue\", \"Blue\")\ndf3 <- data.frame(obs, xvals, yvals, class_label)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf3 |>\n  ggplot() +\n  geom_point(aes(x = xvals, y = yvals, color = class_label),\n             size = 5) +\n  coord_equal() +\n  scale_color_identity() +\n  labs(title = \"Where to Draw the Separating Hyperplane?\",\n       # subtitle = \"y = x - 0.5\",\n       caption = \"ISLR\",\n       x = \"X1\", y = \"X2\") +\n  theme_minimal() +\n  xlim(0,5) + ylim(0,5)\n```\n\n::: {.cell-output-display}\n![](inequalities_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n(b)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf3 |>\n  ggplot() +\n  \n  # separating hyperplane\n  geom_segment(aes(x = 0.5, y = 0, xend = 5, yend = 4.5),\n               color = \"black\", linetype = 1, linewidth = 3) +\n  \n  # margins\n  geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),\n               color = \"black\", linetype = 2, linewidth = 2) +\n  geom_segment(aes(x = 1, y = 0, xend = 5, yend = 4),\n               color = \"black\", linetype = 2, linewidth = 2) +\n  \n  geom_point(aes(x = xvals, y = yvals, color = class_label),\n             size = 5) +\n    coord_equal() +\n  scale_color_identity() +\n  labs(title = \"Separating Hyperplane\",\n       subtitle = \"y = x - 0.5\",\n       caption = \"ISLR\",\n       x = \"X1\", y = \"X2\") +\n  theme_minimal() +\n  xlim(0,5) + ylim(0,5)\n```\n\n::: {.cell-output-display}\n![](inequalities_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n(e)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf3e <- df3 |>\n  mutate(supp_vec = ifelse(obs %in% c(2,3,5,6), \n                           \"support vector\", \"other data\"))\n  \ndf3e$supp_vec <- factor(df3e$supp_vec,\n                        levels = c(\"support vector\", \"other data\"))\n  \ndf3e |>  \n  ggplot() +\n  \n  # separating hyperplane\n  geom_segment(aes(x = 0.5, y = 0, xend = 5, yend = 4.5),\n               color = \"black\", linetype = 1, linewidth = 3) +\n  \n  # margins\n  geom_segment(aes(x = 0, y = 0, xend = 5, yend = 5),\n               color = \"black\", linetype = 2, linewidth = 2) +\n  geom_segment(aes(x = 1, y = 0, xend = 5, yend = 4),\n               color = \"black\", linetype = 2, linewidth = 2) +\n  \n  geom_point(aes(x = xvals, y = yvals, color = supp_vec),\n             size = 5) +\n    coord_equal() +\n  scale_color_manual(values = c(\"purple\", \"gray50\")) +\n  labs(title = \"Separating Hyperplane\",\n       subtitle = \"y = x - 0.5\",\n       caption = \"ISLR\",\n       x = \"X1\", y = \"X2\") +\n  theme_minimal() +\n  xlim(0,5) + ylim(0,5)\n```\n\n::: {.cell-output-display}\n![](inequalities_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n(g)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf3 |>\n  ggplot() +\n  \n  # separating hyperplane\n  geom_segment(aes(x = 0, y = 1/4, xend = 5, yend = 16/4),\n               color = \"black\", linetype = 1, linewidth = 3) +\n  \n  geom_point(aes(x = xvals, y = yvals, color = class_label),\n             size = 5) +\n    coord_equal() +\n  scale_color_identity() +\n  labs(title = \"Separating Hyperplane (not optimal)\",\n       subtitle = \"y = 0.25(3x+1)\",\n       caption = \"ISLR\",\n       x = \"X1\", y = \"X2\") +\n  theme_minimal() +\n  xlim(0,5) + ylim(0,5)\n```\n\n::: {.cell-output-display}\n![](inequalities_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n(h)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnew_dot <- data.frame(obs = 8, xvals = 0, yvals = 5, class_label = \"blue\")\ndf3h <- rbind(df3, new_dot)\ndf3h |>\n  ggplot() +\n  geom_point(aes(x = xvals, y = yvals, color = class_label),\n             size = 5) +\n  coord_equal() +\n  scale_color_identity() +\n  labs(title = \"Where to Draw the Separating Hyperplane?\",\n       subtitle = \"new data at (0,5)\",\n       caption = \"ISLR\",\n       x = \"X1\", y = \"X2\") +\n  theme_minimal() +\n  xlim(0,5) + ylim(0,5)\n```\n\n::: {.cell-output-display}\n![](inequalities_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.0 (2023-04-21 ucrt)\nPlatform: x86_64-w64-mingw32/x64 (64-bit)\nRunning under: Windows 10 x64 (build 19045)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/Los_Angeles\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] ggplot2_3.4.2 dplyr_1.1.2  \n\nloaded via a namespace (and not attached):\n [1] vctrs_0.6.2       cli_3.6.1         knitr_1.43        rlang_1.1.1      \n [5] xfun_0.39         generics_0.1.3    jsonlite_1.8.4    labeling_0.4.2   \n [9] glue_1.6.2        colorspace_2.1-0  htmltools_0.5.5   scales_1.2.1     \n[13] fansi_1.0.4       rmarkdown_2.22    grid_4.3.0        munsell_0.5.0    \n[17] evaluate_0.21     tibble_3.2.1      fastmap_1.1.1     yaml_2.3.7       \n[21] lifecycle_1.0.3   compiler_4.3.0    htmlwidgets_1.6.2 pkgconfig_2.0.3  \n[25] rstudioapi_0.14   farver_2.1.1      digest_0.6.31     R6_2.5.1         \n[29] tidyselect_1.2.0  utf8_1.2.3        pillar_1.9.0      magrittr_2.0.3   \n[33] withr_2.5.0       tools_4.3.0       gtable_0.3.3     \n```\n:::\n:::\n",
    "supporting": [
      "inequalities_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}