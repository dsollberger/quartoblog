{
  "hash": "1715f1b906fe2b930c233a7e8e0cf6a9",
  "result": {
    "markdown": "---\ntitle: \"Bump\"\nauthor: \"Derek Sollberger\"\ndate: \"2022-08-12\"\ncategories: [sports]\n---\n\n\nToday I want to try to make a `bump` plot while practicing with sports data.  The `Lahman` data set has a lot of historical data about Major League Baseball.  Data scientists have been using bump plots for a few years now, but currently I wish to credit [this code](https://github.com/AlbertRapp/PublicTidyTuesday/blob/main/2022_w28_euroflights/2022_w28_euroflights.qmd) by Albert Rapp.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"ggbump\")\nlibrary(\"Lahman\")\nlibrary(\"tidyverse\")\n```\n:::\n\n\nFor today's easy foray, let us seek out the wins and losses of teams in the `Teams` data frame (I tend to call my data frames `df` for typing ease).\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- Teams\n```\n:::\n\n\nThere are about 3000 observations and 48 variables.  I will need some of the column names.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"yearID\"         \"lgID\"           \"teamID\"         \"franchID\"      \n [5] \"divID\"          \"Rank\"           \"G\"              \"Ghome\"         \n [9] \"W\"              \"L\"              \"DivWin\"         \"WCWin\"         \n[13] \"LgWin\"          \"WSWin\"          \"R\"              \"AB\"            \n[17] \"H\"              \"X2B\"            \"X3B\"            \"HR\"            \n[21] \"BB\"             \"SO\"             \"SB\"             \"CS\"            \n[25] \"HBP\"            \"SF\"             \"RA\"             \"ER\"            \n[29] \"ERA\"            \"CG\"             \"SHO\"            \"SV\"            \n[33] \"IPouts\"         \"HA\"             \"HRA\"            \"BBA\"           \n[37] \"SOA\"            \"E\"              \"DP\"             \"FP\"            \n[41] \"name\"           \"park\"           \"attendance\"     \"BPF\"           \n[45] \"PPF\"            \"teamIDBR\"       \"teamIDlahman45\" \"teamIDretro\"   \n```\n:::\n:::\n\n\nTo make a quick exploration, let us `filter` for the past 10 seasons of baseball (2012 to 2021) and `select` the columns I will use later.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- Teams |>\n  filter(yearID >= 2012) |>\n  select(yearID, lgID, franchID, divID, Rank)\nhead(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  yearID lgID franchID divID Rank\n1   2012   NL      ARI     W    3\n2   2012   NL      ATL     E    2\n3   2012   AL      BAL     E    2\n4   2012   AL      BOS     E    5\n5   2012   AL      CHW     C    2\n6   2012   NL      CHC     C    5\n```\n:::\n:::\n\n\nTo be honest, I thought I was going to have to code up some function to rank team wins within the MLB divisions, but the `Lahman` database already has that!\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_left <- df |> filter(yearID == 2012 & lgID == \"NL\")\ndf_right <- df |> filter(yearID == 2021 & lgID == \"NL\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |>\n  filter(lgID == \"NL\") |>\n  ggplot(aes(x = yearID, y = -Rank, color = franchID)) +\n  geom_bump(size = 2) +\n  geom_point(aes(x = yearID, y = -Rank, color = franchID),\n             size = 5) +\n  geom_label(aes(x = yearID, y = -Rank, label = franchID), data = df_left) +\n  geom_label(aes(x = yearID, y = -Rank, label = franchID), data = df_right) +\n  facet_wrap(. ~ divID, ncol = 1) +\n  labs(title = \"National League Standings\",\n       subtitle = \"early draft of bump plot\",\n       caption = \"Derek Sollberger\") +\n  theme(legend.position = \"none\",\n        panel.background = element_blank())\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in f(...): 'StatBump' needs at least two observations per group\n```\n:::\n\n::: {.cell-output-display}\n![](bump_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n![bump plot](bump.png)",
    "supporting": [
      "bump_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}