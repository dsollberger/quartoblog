{
  "hash": "4e66cd03e0e8f38dc6747b3d71581080",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"RNA-Seq Exploratory Data Analysis\"\nauthor: \"Derek Sollberger\"\ndate: \"2025-08-17\"\nformat:\n  closeread-html:\n    fig-width: 6\n    narrative-background-color-sidebar: lightyellow\n    remove-header-space: true\n---\n\n\n\n:::{.cr-section layout=\"sidebar-left\"}\n\n# RNA-Seq Exploratory Data Analysis\n\n@cr-setup\n\n::::{#cr-setup}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Bioconductor\nlibrary(\"airway\")\nlibrary(\"ComplexHeatmap\")\nlibrary(\"DESeq2\")\nlibrary(\"org.Hs.eg.db\")\nlibrary(\"SummarizedExperiment\")\ndata(airway)\n\n# data visualization\nlibrary(\"circlize\")\nlibrary(\"ggplot2\")\nlibrary(\"ggtext\")\n\n# data wrangling\nlibrary(\"dplyr\")\nlibrary(\"magrittr\")\nlibrary(\"tidyr\")\n```\n:::\n\n\n::::\n\nTo conclude an online course in RNA-seq analysis, here I hope to review our materials into a concise presentation adorned with `closeread`. I shall work with the `airway` data set found in some **Bioconductor** documentation---in fact, I will be adapting from the [EnhancedVolcano manual](https://bioconductor.org/packages/devel/bioc/vignettes/EnhancedVolcano/inst/doc/EnhancedVolcano.html) by Blighe, Rana, and Lewis---while also implementing the tools found in the course presented by Dean Lee.\n\n:::\n\n:::{.cr-section layout=\"sidebar-left\"}\n# Data Set\n\n@cr-dex_image\n\n::::{#cr-dex_image}\n![dexamethoasone](images/dexamethasone.png)\n::::\n\nThe `airway` package in the Bioconductor suite is maintained by Michael Love, and it contains data from the experiment results published by Himes, et al in 2014. \"that summarizes an RNA-seq experiment wherein airway smooth muscle cells were treated with dexamethasone, a synthetic glucocorticoid steroid with anti-inflammatory effects\".\n:::\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\nIn the *RangedSummarizedExperiment object*, we can use the `rowData` command from `SummarizedExperiment` to look at meta data that has been collected about the **reads**. Here, I then present only the column names of that `rowData` for brevity.\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"gene_id\"          \"gene_name\"        \"entrezid\"         \"gene_biotype\"    \n [5] \"gene_seq_start\"   \"gene_seq_end\"     \"seq_name\"         \"seq_strand\"      \n [9] \"seq_coord_system\" \"symbol\"           \"exonic_length\"   \n```\n\n\n:::\n:::\n\n\n\nIn the *RangedSummarizedExperiment object*, we can use the `rowData` command from `SummarizedExperiment` to look at meta data that has been collected about the **samples**. Here, I then present only a subset of that `colData` for brevity.\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nDataFrame with 6 rows and 6 columns\n           SampleName     cell      dex    albut        Run avgLength\n             <factor> <factor> <factor> <factor>   <factor> <integer>\nSRR1039508 GSM1275862  N61311     untrt    untrt SRR1039508       126\nSRR1039509 GSM1275863  N61311     trt      untrt SRR1039509       126\nSRR1039512 GSM1275866  N052611    untrt    untrt SRR1039512       126\nSRR1039513 GSM1275867  N052611    trt      untrt SRR1039513        87\nSRR1039516 GSM1275870  N080611    untrt    untrt SRR1039516       120\nSRR1039517 GSM1275871  N080611    trt      untrt SRR1039517       126\n```\n\n\n:::\n:::\n\n\n\n## Toward Gene Expression\n\nOverall, I want to focus on the genes and the **assay** of counts of gene expression. Continuing with the `EnhancedVolcano` documentation, we \"annotate the Ensembl gene IDs to gene symbols\".\n\n\n\n::: {.cell}\n\n:::\n\n\n\n:::{.cr-section layout=\"sidebar-left\"}\n## Variance Stabilizing Transformation\n\n@cr-vst_image\n\n::::{#cr-vst_image}\n![VST](images/week_2_vst.png)\n::::\n\nTo the best of my novice knowledge, lab technicians can obtain **reads** of the RNA-Seq at various levels of quality and \"better\" reads can come from multiple scans.  However, when seeking *counts* of gene expression, some genes now have much more representation than others simply from the scanning processes.  We perform **variance stabilizing transformation** to *normalize* the data to treat the sequence data more similarly.\n:::\n\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n:::{.cr-section layout=\"sidebar-left\"}\n\n# Principal Component Analysis\n\nAcross scans of various genes, we have a high-dimensional matrix of counts.  In hopes of seeking out patterns, we can perform **principal component analysis** (PCA) and project the data into a lower dimensional space and see if there are perhaps some clusters there.  Here, we retain the first two principal components that may already capture the majority of the variance and also is easy to visualize.\n\n\n\n::: {.cell}\n\n:::\n\n\n\n@cr-pca_plot\n\n::::{#cr-pca_plot}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](RNA_Seq_wrapup_EDA_files/figure-html/unnamed-chunk-8-1.png){width=576}\n:::\n:::\n\n\n::::\n\nIn this example of PCA, the treated cell lines and the untreated cell lines are clearly separated by the first principal component. This gives us some encouragement that the medical intervention is indeed affecting these lung cells.\n\n:::\n\n:::{.cr-section layout=\"sidebar-left\"}\n# Hierarchical Clustering\n\nEarlier, we used the `DESeq` function from Bioconductor to set us on the path toward differential expression analysis.  For now, we take a numerical matrix of counts of the gene expression, compute the Euclidian distances between matrix entries, and organize the distances---starting with the shortest---in a process called **hierarchical clustering**. Like other clustering algorithms, we hope to use this unsupervised learning approach to encounter underlying structure in the data.\n\n@cr-hc_k2\n\n::::{#cr-hc_k2}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](RNA_Seq_wrapup_EDA_files/figure-html/unnamed-chunk-9-1.png){width=768}\n:::\n:::\n\n\n::::\n\nThe Bioconductor community provides a `ComplexHeatmap` package to handle a lot of these ideas simultaneously. We start by assuming $k = 2$ clusters and *cut off* the **dendrogram** (treemodel) where there would be 2 clusters.  Upon looking at the *annotation* (here: the Dexamethasone treatment), we don't seem to have discerning patterns at 2 clusters.\n\n@cr-hc_k4\n\n::::{#cr-hc_k4}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](RNA_Seq_wrapup_EDA_files/figure-html/unnamed-chunk-10-1.png){width=768}\n:::\n:::\n\n\n::::\n\nTweaking the exploration up to $k = 3$ and then $k = 4$ clusters, we now have some clusters that separate the genes that may be affected differently from the Dexamethasone treatment. In the [search](https://biocorecrg.github.io/CRG_Bioinformatics_for_Biologists/differential_gene_expression.html) for **more expressed** or **less expressed** genes, we have respectively candidates\n\n* **up-regulated** genes: ITIH5, SAMHD1, GPX3\n* **down-regulated** genes: RPS4Y1, DDX3Y, USP9Y, KDM5D\n\nOf course, this is a tutorial data set and exploration.  A more complex data set might display clustering better.\n\n:::\n\n:::{.cr-section layout=\"sidebar-left\"}\n# Differential Expression Analysis\n\nIt appears that the main bioinformatics technique in RNA-Seq is **differential expression analysis**.  After normalizing the data (understanding sequence lengths and number of reads), we compare group means and overall means like in statistical tests.  Here, I focus on $\\log_{2}$ **fold change** to discuss the *less expressed* or *more expressed* genes.\n\n\n\n::: {.cell}\n\n:::\n\n\n\n@cr-DEA_plot\n\n::::{#cr-DEA_plot}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](RNA_Seq_wrapup_EDA_files/figure-html/unnamed-chunk-12-1.png){width=576}\n:::\n:::\n\n\n::::\n\n## Results\n\nIn these calculations, the differential expression analysis yielded\n\n* **up-regulated** genes: XIST, GAS7, GPB3\n* **down-regulated** genes: RPS4Y1, USP9Y, UTY\n\nwhere we have also noted that RPS4Y1, USP9Y were highly less expressed in the hierarchical clustering. Gene RPS4Y1 is involved in protein syntheis and may be related to cancer growth. Gene USP9Y is involved in protein turnover and has been associated with lung cancer.  It appears that the dexamethasone steroid suppressed these genes.\n\nAmong the more expressed genes, it appears that the dexamethasone steroid activated GPB3 in particular.  That gene may affect energy metabolism in lung cells.\n\n:::",
    "supporting": [
      "RNA_Seq_wrapup_EDA_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}