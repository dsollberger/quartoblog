{
  "hash": "98c03f763ac28f4d3ba15f94ef9ff379",
  "result": {
    "markdown": "---\ntitle: \"Intentional Walks\"\nauthor: \"Derek Sollberger\"\ndate: 'Fri Aug 26 2022 23:48:23 BST'\ncategories: [baseball]\n---\n\n\nToday's exploration and visualization practive was inspired by [this tweet](https://mobile.twitter.com/PassonJim/status/1562988124808318976):\n\n\"Barry Bonds has over 200 more intentional walks than the Rays entire franchise.\" --- Cespedes Family BBQ, Dec. 2, 2013\n\n\"Almost nine years later and Bonds still has 28 more intentional walks than the Rays franchise.\" --- Jim Passon, Aug. 25, 2022\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"ggtext\")\nlibrary(\"tidyverse\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ ggplot2 3.3.6     ✔ purrr   0.3.4\n✔ tibble  3.1.7     ✔ dplyr   1.0.9\n✔ tidyr   1.2.0     ✔ stringr 1.4.0\n✔ readr   2.1.2     ✔ forcats 0.5.1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n:::\n\n\n\n## Gathering the Data\n\nAt first, I thought that I could reasonably type in all of the data, but [Bonds' career](https://www.baseball-reference.com/players/b/bondsba01.shtml) was quite long.  I copy-and-pasted the batting table from Baseball Reference and focused on the `Year` and `IBB` columns.\n\nThe franchise page for the Tampa Bay Rays did not have intentional walks quickly accessible, so I simply went through the [year-by-year pages](https://www.baseball-reference.com/teams/TBD/1998.shtml) and gathered the `IBB` total (fortunately easy to find visually as the last column).\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_bonds <- readxl::read_xlsx(\"ibb.xlsx\", sheet = \"Bonds\")\ndf_rays  <- readxl::read_xlsx(\"ibb.xlsx\", sheet = \"Rays\")\n```\n:::\n\n\n## Data Wrangling\n\nWhile I could probably affect the horizontal axis later in a `ggplot` visualization, I prefer today to have the data in one data frame.  Let me merge the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df_bonds |>\n  full_join(df_rays, by = \"Year\") |>\n  rename(\"IBB_Bonds\" = \"IBB.x\",\n        \"IBB_Rays\" = \"IBB.y\")\n```\n:::\n\n\nThe naturally missing values probably would not affect the calculations much, but for peace of mind, let us impute those values to be zeroes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf$IBB_Bonds[is.na(df$IBB_Bonds)] <- 0\ndf$IBB_Rays[is.na(df$IBB_Rays)]   <- 0\n```\n:::\n\n\nIn the spirit of the tweet, we will need to talk about cumulative totals.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df |>\n  mutate(IBB_Bonds_total = cumsum(IBB_Bonds),\n         IBB_Rays_total  = cumsum(IBB_Rays))\n```\n:::\n\n\n## Data Visualization\n\nWhile line graphs (with areas filled) would probably be the most visually appealing, it might be better to treat seasons as discrete entries in a bar plot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |>\n  ggplot() +\n  geom_bar(aes(x = Year, y = IBB_Bonds_total),\n           stat = \"identity\")\n```\n\n::: {.cell-output-display}\n![](ibb_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nNow I am curious what the bars will look like in team colors.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbaseplot <- df |>\n  ggplot() +\n  \n  # https://teamcolorcodes.com/san-francisco-giants-color-codes/\n  geom_bar(aes(x = Year, y = IBB_Bonds_total),\n           color = \"#27251F\", fill = \"#FD5A1E\",\n           stat = \"identity\") +\n  \n  # https://teamcolorcodes.com/tampa-bay-rays-color-codes/\n  geom_bar(aes(x = Year, y = IBB_Rays_total),\n           color = \"#8FBCE6\", fill = \"#092C5C\",\n           stat = \"identity\")\n\n# print\nbaseplot\n```\n\n::: {.cell-output-display}\n![](ibb_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nMoving toward aesthetic beauty, I will update some of the theme elements.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# some ideas from\n# https://github.com/nikopech/TidyTuesday/blob/master/R/2022-08-09/2022_08_09_ferris_wheels.R\n\ncurrent_plot <- baseplot +\n  labs(title = \"\",\n       subtitle = \"\",\n       caption = \"Derek Sollberger | August 26, 2022\",\n       x = \"season\",\n       y = \"intentional walk cumulative total\") +\n  theme(legend.position = \"none\",\n        panel.background = element_blank(),\n        plot.background = element_rect(\n            fill = \"#FFFFFF\", \n            color = \"#27251F\"\n        ),\n        plot.title = element_markdown(face = \"italic\",\n                                      margin = margin(b = 5),\n                                      size = 14),\n        plot.title.position = \"plot\",\n        plot.subtitle = element_markdown(face = \"italic\",\n                                         margin = margin(b = 5),\n                                         size = 12),\n        plot.caption = element_markdown(margin = margin(t = 0), \n                                        size = 10),\n        plot.caption.position = \"plot\",\n        plot.margin = margin(50, 50, 50, 50))\n\n# print\ncurrent_plot\n```\n\n::: {.cell-output-display}\n![](ibb_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nNow, I am going to attempt to add arrows (and later: labels) to highlight certain areas of the graph.  This is still very new to me, so fingers crossed.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncurrent_plot +\n  # In 2004, Barry Bonds received 120 intentional walks\n  annotate(color = \"#FD5A1E\",\n           geom = \"curve\",\n           size = 0.5,\n           x = 1999, xend = 2004,\n           y = 800, yend = 604) +\n  geom_textbox(aes(x = 1999, y = 800,\n                   color = \"#000000\",\n                   label = \"In 2004, Barry Bonds received 120 intentional walks\"),\n               size = 2) +\n  \n  # Start of Barry Bonds' MLB career\n  annotate(color = \"#FD5A1E\",\n           geom = \"curve\",\n           size = 0.5,\n           x = 1988, xend = 1986,\n           y = 200, yend = 0) +\n  geom_textbox(aes(x = 1988, y = 200,\n                   color = \"#000000\",\n                   label = \"Start of Barry Bonds' MLB career\"),\n               size = 2)\n```\n\n::: {.cell-output-display}\n![](ibb_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# print\n# current_plot\n```\n:::\n\n\nAt the moment, I am having difficulty getting labels to naturally appear beyond the `panel`.\n\nInstead, I will focus on the title and caption.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# some ideas from\n# https://github.com/nikopech/TidyTuesday/blob/master/R/2022-08-09/2022_08_09_ferris_wheels.R\n\ncurrent_plot <- baseplot +\n  labs(title = \"From 1986 to 2007, Barry Bonds accumulated 688 intentional walks\",\n       subtitle = \"From 1998 to present, the Tampa Bay Rays have accumulated 28 fewer walks\",\n       caption = \"Derek Sollberger | August 26, 2022\",\n       x = \"season\",\n       y = \"intentional walk cumulative total\") +\n  theme(legend.position = \"none\",\n        panel.background = element_blank(),\n        plot.background = element_rect(\n            fill = \"#FFFFFF\", \n            color = \"#27251F\"\n        ),\n        plot.title = element_text(color = \"#FD5A1E\", size = 14, hjust = 0.5),\n        plot.title.position = \"plot\",\n        plot.subtitle = element_text(color = \"#092C5C\", size = 12, hjust = 0.5),\n        plot.caption = element_markdown(margin = margin(t = 0), \n                                        size = 10),\n        plot.caption.position = \"plot\",\n        plot.margin = margin(20, 20, 20, 20))\n\n# print\ncurrent_plot\n```\n\n::: {.cell-output-display}\n![](ibb_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n![](ibb.png)",
    "supporting": [
      "ibb_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}